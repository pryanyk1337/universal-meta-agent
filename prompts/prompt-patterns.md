# Паттерны промптов для создания эффективных AI-агентов

## Введение
Этот документ содержит проверенные паттерны и техники написания промптов для создания качественных AI-агентов. Использование этих паттернов повышает точность, последовательность и качество работы агента.

## Базовые принципы

### 1. Специфичность
❌ **Плохо**: "Помоги с текстами"
✅ **Хорошо**: "Создай продающее описание товара для интернет-магазина, длиной 150-200 слов, с акцентом на выгоды покупателя"

### 2. Контекст
Всегда предоставляйте контекст:
- Кто агент
- Для кого работает
- Какая цель
- Какие ограничения

### 3. Примеры
Показывайте, не рассказывайте. Один хороший пример лучше длинного описания.

### 4. Структура
Организованная информация → лучшие результаты

## Паттерн 1: Определение роли

### Структура:
```
Ты — [конкретная роль] с [уровень] экспертизы в [область].
Твоя специализация — [узкая ниша].
Твой стиль — [характеристики стиля].
```

### Пример:
```
Ты — Senior Java-разработчик с 10+ годами опыта в enterprise-разработке.
Твоя специализация — создание микросервисов на Spring Boot.
Твой стиль — чистый код, следование SOLID принципам, акцент на maintainability.
```

### Почему работает:
Чёткая роль задаёт контекст и уровень экспертизы, что влияет на глубину и качество ответов.

## Паттерн 2: Формат ответа

### Структура:
```
Когда получаешь [тип запроса], отвечай в следующем формате:
1. [Элемент 1]
2. [Элемент 2]
3. [Элемент 3]
...
```

### Пример:
```
Когда получаешь задачу на код-ревью, отвечай в следующем формате:
1. Краткий summary (что хорошо, что нужно улучшить)
2. Критические проблемы (безопасность, баги)
3. Улучшения архитектуры
4. Code style замечания
5. Рекомендации
```

### Почему работает:
Предсказуемая структура облегчает восприятие и обеспечивает полноту ответа.

## Паттерн 3: Few-Shot Learning (Обучение на примерах)

### Структура:
```
Вот примеры задач и правильных решений:

Пример 1:
Запрос: [...]
Ответ: [...]

Пример 2:
Запрос: [...]
Ответ: [...]

Теперь реши подобную задачу:
Запрос: [новая задача]
```

### Пример:
```
Вот примеры создания метафор:

Пример 1:
Тема: Время
Метафора: "Время — река, что уносит всё на своём пути"

Пример 2:
Тема: Память
Метафора: "Память — сундук, где хранятся сокровища прошлого"

Создай метафору для темы: Любовь
```

### Почему работает:
Примеры показывают желаемый стиль, уровень детализации и подход.

## Паттерн 4: Пошаговое мышление (Chain of Thought)

### Структура:
```
При решении задачи:
1. Сначала проанализируй [аспект 1]
2. Затем рассмотри [аспект 2]
3. Оцени [аспект 3]
4. Только после этого предложи решение
```

### Пример:
```
При написании стихотворения:
1. Определи настроение и тему
2. Выбери стихотворный размер и рифму
3. Создай ключевые образы
4. Напиши черновик
5. Отшлифуй звучание и смысл
```

### Почему работает:
Явное указание процесса мышления улучшает качество рассуждений и конечного результата.

## Паттерн 5: Ограничения и границы

### Структура:
```
Ты МОЖЕШЬ:
- [действие 1]
- [действие 2]

Ты НЕ МОЖЕШЬ:
- [ограничение 1]
- [ограничение 2]

При столкновении с [ситуация], делай [действие].
```

### Пример:
```
Ты МОЖЕШЬ:
- Консультировать по трудовому праву РФ
- Помогать составлять претензии

Ты НЕ МОЖЕШЬ:
- Давать гарантии исхода дела
- Представлять в суде
- Консультировать по уголовным делам

При сложном деле рекомендуй обратиться к практикующему юристу.
```

### Почему работает:
Чёткие границы предотвращают выход за рамки компетенции и устанавливают правильные ожидания.

## Паттерн 6: Критерии качества

### Структура:
```
Твои ответы должны соответствовать критериям:
- [критерий 1]: [описание]
- [критерий 2]: [описание]
- [критерий 3]: [описание]
```

### Пример:
```
Твои маркетинговые тексты должны:
- Быть конкретными: использовать цифры, факты, не общие фразы
- Фокусироваться на выгодах: не характеристики, а польза для клиента
- Иметь чёткий CTA: призыв к действию в конце
- Быть сканируемыми: короткие абзацы, списки, подзаголовки
```

### Почему работает:
Явные критерии качества служат внутренним чек-листом для агента.

## Паттерн 7: Адаптация к аудитории

### Структура:
```
Адаптируй сложность и стиль под аудиторию:
- Для [аудитория 1]: [стиль 1]
- Для [аудитория 2]: [стиль 2]
- Для [аудитория 3]: [стиль 3]
```

### Пример:
```
Адаптируй объяснения:
- Для новичков: простым языком, с аналогиями, без жаргона
- Для middle: технические термины OK, но с пояснениями
- Для экспертов: полная терминология, фокус на нюансах
```

### Почему работает:
Гибкость в коммуникации повышает полезность агента для разных пользователей.

## Паттерн 8: Уточняющие вопросы

### Структура:
```
Если информации недостаточно, задай уточняющие вопросы:
- [вопрос 1] для понимания [аспект 1]
- [вопрос 2] для понимания [аспект 2]
- [вопрос 3] для понимания [аспект 3]
```

### Пример:
```
При неполном запросе на дизайн, спроси:
- Какая целевая аудитория?
- Какое настроение/стиль предпочитаете?
- Есть ли брендбук или референсы?
- Где будет использоваться дизайн?
- Какие технические ограничения?
```

### Почему работает:
Активное уточнение обеспечивает более точный и релевантный результат.

## Паттерн 9: Самопроверка

### Структура:
```
Перед выдачей ответа проверь:
- [ ] [критерий 1]
- [ ] [критерий 2]
- [ ] [критерий 3]
```

### Пример:
```
Перед отправкой кода проверь:
- [ ] Код компилируется без ошибок
- [ ] Следует стандартам форматирования
- [ ] Есть обработка edge cases
- [ ] Добавлены комментарии для сложной логики
- [ ] Нет хардкода credentials
```

### Почему работает:
Встроенная самопроверка повышает качество и уменьшает ошибки.

## Паттерн 10: Контекстная память

### Структура:
```
Запоминай в ходе разговора:
- [информация 1]: используй для [цель]
- [информация 2]: учитывай при [ситуация]
- [информация 3]: возвращайся к этому при [условие]
```

### Пример:
```
Запоминай предпочтения клиента:
- Стиль письма: применяй в последующих текстах
- Целевая аудитория: адаптируй tone of voice
- Табу-слова: избегай их
- Успешные примеры: используй как референс
```

### Почему работает:
Контекстная осведомлённость создаёт персонализированный опыт.

## Продвинутые паттерны

### Паттерн 11: Мета-когниция (мышление о мышлении)

```
При сложной задаче:
1. Оцени уровень сложности (1-10)
2. Определи, какие подходы применимы
3. Выбери оптимальный подход и объясни почему
4. Реши задачу
5. Рефлексия: что можно улучшить?
```

**Применение**: Для задач требующих творческого или аналитического мышления.

### Паттерн 12: Противоположная точка зрения

```
После предложения решения:
1. Сгенерируй альтернативный подход
2. Приведи аргументы "за" и "против" каждого
3. Помоги клиенту выбрать оптимальное
```

**Применение**: Для консультационных агентов, где важно рассмотреть варианты.

### Паттерн 13: Итеративное улучшение

```
Процесс работы:
1. Создай первую версию
2. Проанализируй слабые места
3. Создай улучшенную версию
4. Повтори при необходимости
5. Предоставь финальный результат
```

**Применение**: Для творческих агентов (писатели, дизайнеры).

### Паттерн 14: Сократовский метод

```
Вместо прямого ответа:
1. Задай наводящий вопрос
2. Помоги клиенту самому прийти к выводу
3. Подтверди или скорректируй понимание
```

**Применение**: Для образовательных и коучинговых агентов.

## Комбинирование паттернов

Наиболее эффективные агенты используют комбинацию паттернов:

### Пример комбинации:
```markdown
# Агент-Копирайтер

## Роль (Паттерн 1)
Ты — профессиональный копирайтер с экспертизой в e-commerce...

## Формат ответа (Паттерн 2)
При создании описания товара:
1. Цепляющий заголовок
2. Описание проблемы клиента
3. Решение (продукт)
4. Выгоды
5. CTA

## Примеры (Паттерн 3)
### Пример 1: Описание наушников
Запрос: [...]
Ответ: [...]

## Критерии качества (Паттерн 6)
Твои тексты должны:
- Фокус на выгодах, не характеристиках
- Конкретные цифры и факты
- Сканируемая структура

## Уточняющие вопросы (Паттерн 8)
Если не хватает информации:
- Какая целевая аудитория?
- Что главная боль клиента?
- Какое УТП продукта?
```

## Антипаттерны (чего избегать)

### ❌ Избыточная общность
"Будь хорошим помощником" — слишком расплывчато

### ❌ Противоречивые инструкции
"Будь кратким" + "Объясняй подробно"

### ❌ Перегрузка инструкциями
Слишком много правил → агент запутается

### ❌ Отсутствие примеров
Без примеров агент не понимает ожидания

### ❌ Неясные критерии
"Делай хорошо" — что значит "хорошо"?

## Тестирование промптов

### Чек-лист:
- [ ] Протестирован на 5+ типичных задачах
- [ ] Проверен на краевых случаях
- [ ] Стиль последователен
- [ ] Качество соответствует ожиданиям
- [ ] Ограничения работают
- [ ] Агент не выходит за рамки компетенции

### Метрики качества:
- **Релевантность**: соответствует ли ответ запросу?
- **Полнота**: учтены ли все аспекты?
- **Стиль**: консистентен ли tone of voice?
- **Глубина**: достаточна ли экспертиза?
- **Применимость**: можно ли использовать результат?

## Итеративное улучшение промптов

### Цикл улучшения:
1. **Создать**: начальная версия промпта
2. **Тестировать**: проверить на задачах
3. **Анализировать**: где проблемы?
4. **Улучшать**: корректировать промпт
5. **Повторить**: пока не достигнете качества

### Что улучшать:
- Добавлять примеры для проблемных случаев
- Уточнять неоднозначные инструкции
- Усиливать слабые места
- Убирать избыточное

## Лучшие практики

### ✅ DO:
- Будьте конкретны и однозначны
- Показывайте примеры
- Структурируйте информацию
- Тестируйте тщательно
- Итерируйте на основе результатов

### ❌ DON'T:
- Не будьте расплывчаты
- Не перегружайте инструкциями
- Не игнорируйте примеры
- Не забывайте об ограничениях
- Не останавливайтесь на первой версии

## Заключение

Эффективные промпты — основа качественных AI-агентов. Используйте эти паттерны как строительные блоки, комбинируйте их и адаптируйте под свои задачи.

**Помните**: лучший промпт — тот, который работает для вашего конкретного случая. Экспериментируйте!
